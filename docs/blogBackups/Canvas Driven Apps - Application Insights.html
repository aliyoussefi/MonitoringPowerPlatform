<h2 class="md-end-block md-heading"><span class="md-plain">Summary</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class=" md-link"><a href="https://docs.microsoft.com/en-us/powerapps/maker/canvas-apps/getting-started" rel="noopener noreferrer" target="_blank"><span class=""><strong><span class="md-plain">Power Apps Canvas Apps</span></strong></span></a></span><span class="md-plain"> represent a no or low code approach to building and delivering modern applications for makers. The requirements of knowing programming languages such as C# have been removed allowing makers of virtually any background to build apps. These apps can be used with hundreds of connectors allowing for a flexible user interface layered on top of data sources. Apps can also be generated from data sources automatically allowing you to quickly create and deploy an application to your team or customers. </span></p>
<p class="md-end-block md-p"><span class="md-plain">This article is designed to introduce designers and analysts to the </span><span class=""><strong><span class="md-plain">Monitoring Tool within Canvas Driven Apps</span></strong></span><span class="md-plain">. In this article, we will discuss how to </span><span class=""><strong><span class="md-plain">get started using the tool</span></strong></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">interacting with the tool and exploring data returned within the tool</span></strong></span><span class="md-plain">. Finally, we will discuss </span><span class=""><strong><span class="md-plain">archiving and sharing session data</span></strong></span><span class="md-plain"> for further analysis.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Application Insights</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p" style="padding-left: 480px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/wiki/aliyoussefi/D365-Monitoring/Artifacts/Generic/App Insights Clear Logo.png"><img height="81" src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009445v17.png" width="154" /></span></p>
<p class="md-end-block md-p"><span class=" md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview" rel="noopener noreferrer" target="_blank"><span class="md-plain">Azure Application Insights is an extensible Application Performance Management (APM) service</span></a></span><span class="md-plain"> that can be used to monitor applications, tests, etc. </span><span class=""><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> can be used with any application hosted in any environment. Depending on what's being monitored there are SDKs available. For other applications connections and message delivery can be programmed using the REST APIs available.</span></p>
<p class="md-end-block md-p"><span class="md-plain">For Power Platform components, Application Insights is recommended due to its direct integration with Power Apps features and tools and its capabilities to deliver to the API. </span></p>
<p class="md-end-block md-p"><span class="md-plain">Once we begin sending telemetry to Application Insights we can review in real time availability tests, user actions, deployment metrics as well as other feedback from our applications. Connecting our messages with correlation identifiers allows us a holistic view into how our apps are interdependent upon each other. This provides the transparency desired and honestly needed with modern era technology.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Adding Application Insights to Canvas Apps</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class=" md-link"><a href="https://docs.microsoft.com/en-us/powerapps/maker/canvas-apps/application-insights" rel="noopener noreferrer" target="_blank"><span class="md-plain">Adding </span><span class=""><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> message delivery is a </span><span><u><span class="md-plain">native feature</span></u></span><span class="md-plain"> of </span><span class=""><strong><span class="md-plain">Power Apps Canvas Apps</span></strong></span><span class="md-plain">.</span></a></span><span class="md-plain"> Once added it will begin to send messages from both the preview player and once deployed, your application in Power Apps. This article from </span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">To add the Instrumentation Key to your Canvas App</span></strong></span><span class="md-plain">, open the Power Apps Studio and </span><span class=""><strong><span class="md-plain">locate the 'App' in the Tree view</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/AppInsights/AddAppInsights.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009446v18.jpeg" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">Next, in the </span><span class=""><strong><span class="md-plain">App Object window</span></strong></span><span class="md-plain"> to the right, add the </span><span class=""><strong><span class="md-plain">Azure Application Insights Instrumentation Key</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p" style="padding-left: 420px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/AddAppInsightsKey.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009446v19.jpeg" /></span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Adding and Locating Identifiers</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Identifiers in Canvas Apps come in various formats including the user playing the </span><span class=""><strong><span class="md-plain">app, the session id, the player version, app version, etc</span></strong></span><span class="md-plain">. These data elements are a must when troubleshooting and monitoring how your users interact with your app. Some of the data points I find valuable are </span><span class=""><strong><span class="md-plain">the app and player build numbers which are key to understanding if users are using out of date player versions</span></strong></span><span class="md-plain">. The other major data point is the </span><span class=""><strong><span class="md-plain">session id</span></strong></span><span class="md-plain">. For an app user, to obtain these values, </span><span class=""><strong><span class="md-plain">navigate to the Settings window and click '</span><em><span class="md-plain">Session details</span></em><span class="md-plain">'.</span></strong></span></p>
<p class="md-end-block md-p" style="padding-left: 420px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/CanvasApp-Settings.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009447v20.jpeg" /></span></p>
<p class="md-end-block md-p"><span class=""><strong><span><u><span class="md-plain">Session Window:</span></u></span></strong></span></p>
<p class="md-end-block md-p" style="padding-left: 420px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/CanvasApp-Settings-SessionWindow.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009447v21.jpeg" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">If a user reports an issue, having </span><span class=""><strong><span class="md-plain">the session id and Power Apps player version can help with troubleshooting</span></strong></span><span class="md-plain">. That said, currently I don't see a way to grab the session id natively using Canvas App functions. However, using the Power Apps connector with Power Automate, the session Id can be obtained and added to a trace entry. </span></p>
<p class="md-end-block md-p"><span class=""><strong><span><u><span class="md-plain">AUTHOR'S NOTE:</span></u></span></strong></span><span class="md-plain"> This article from </span><span class=" md-link"><a href="https://powerapps.microsoft.com/en-us/blog/author/aheaney/" rel="noopener noreferrer" target="_blank"><span class="md-plain">Aengus Heaney</span></a></span><span class="md-plain"> titled "</span><span class=" md-link"><a href="https://powerapps.microsoft.com/en-us/blog/log-telemetry-for-your-apps-using-azure-application-insights/" rel="noopener noreferrer" target="_blank"><span class="md-plain">Log telemetry for your Apps using Azure Application Insights</span></a></span><span class="md-plain md-expand">" details that this feature is coming. I would suggest, unless needed immediately, to avoid the Power Automate customization. This feature will eliminate the need for using the Power Apps connector in this fashion, I'm very excited to see its coming! I'll update this article once this is available.</span></p>
<p class="md-end-block md-p"><span class="md-plain md-expand"><img alt="" height="401" src="/cfs-file/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/SessionIdBetweenCanvasAppAndAppInsights.gif" width="762" /></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/AppInsights/SessionIdBetweenCanvasAppAndAppInsights.gif"></span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Adding Traces</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class=""><strong><span class="md-plain">Trace function</span></strong></span><span class="md-plain"> is used to send messages to the </span><span class=""><strong><span class="md-plain">traces</span></strong></span><span class="md-plain"> table in </span><span class=""><strong><span class="md-plain">Application Insights</span></strong></span><span class="md-plain">. This allows makers the </span><span class=""><strong><span class="md-plain">ability to add telemetry and instrumentation from practically any control on any screen</span></strong></span><span class="md-plain">. This also opens us up to generating identifiers for specific actions which can be used for troubleshooting in a live environment. The below image shows using informational traces to </span><span class=""><strong><span class="md-plain">capture the timings between the invocation of a Power Automate flow</span></strong></span><span class="md-plain">. The image shows a trace for the button click, and entries for </span><span class=""><strong><span class="md-plain">adding instrumentation for a Power Automate flow</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p" style="padding-left: 330px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuildsScreen-Telemetry-PowerAutomate.JPG"><img height="44" src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009448v23.jpeg" width="440" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">The image below is the result of the Trace methods showing the message and the time stamp for each entry. </span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuilds-AppInsights-Telemetry-GetBuilds.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009448v24.jpeg" /></span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">Traces can three types</span></strong></span><span class="md-plain">: Information (for operational activities), Warnings (non breaking issue), or Errors (breaking issue).</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuildsScreen-Telemetry-TraceSeverity.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009448v25.jpeg" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">Based on the severity level, the Application Insights record will change.</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuilds-AppInsights-Telemetry-TraceSeverity.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009449v26.jpeg" /></span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Exploring what's delivered</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">At the time of this writing the tables data is delivered to natively </span><span class=""><strong><span class="md-plain">include the </span><em><span class="md-plain">customEvents</span></em><span class="md-plain">, </span><em><span class="md-plain">pageViews</span></em><span class="md-plain"> and </span><em><span class="md-plain">browserTimings</span></em><span class="md-plain"> tables</span></strong></span><span class="md-plain">. Each table contains generic </span><span class=""><strong><span class="md-plain">Azure Application Insights properties</span></strong></span><span class="md-plain"> as well as specific relevant properties. </span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/AppInsights/AppInsights.NativeAppEntries.png"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009449v27.png" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class=""><strong><em><span class="md-plain">customEvents</span></em></strong></span><span class="md-plain"> table shows </span><span class=""><strong><span class="md-plain">when the published app was started</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuilds-AppInsights-Telemetry-customEvents.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009449v28.jpeg" /></span></p>
<p class="md-end-block md-p"><span class=""><strong><em><span class="md-plain">pageViews</span></em></strong></span><span class="md-plain"> - The </span><span class=""><strong><span class="md-plain">pageViews</span></strong></span><span class="md-plain"> table is </span><span class=""><strong><span class="md-plain">included when Azure Application Insights is added to Canvas Apps</span></strong></span><span class="md-plain">. The message received by </span><span class=""><strong><span class="md-plain">Application Insights</span></strong></span><span class="md-plain"> contains the URL, the name of the screen within your app and the duration as well as a handy performance bucket. Using the duration along with contextual information from the session and user we can begin to identify performance concerns.</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuilds-AppInsights-Telemetry-pageViews.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009449v29.jpeg" /></span></p>
<p class="md-end-block md-p"><span><u><span class="md-plain">NOTE: I have seen the </span><span class=""><strong><span class="md-plain">pageViews</span></strong></span><span class="md-plain"> duplicate duration across all screens. Consider adding trace events in the </span><span class=""><strong><span class="md-plain">Maker Defined Events</span></strong></span><span class="md-plain"> section or a technique to find the difference between </span><span class=""><strong><span class="md-plain">pageView</span></strong></span><span class="md-plain"> entries in Kusto.</span></u></span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">browserTimings</span></strong></span><span class="md-plain"> - This represents browser interactions including the send and receive duration, the client processing time and the all up total duration. Similar to the </span><span class=""><strong><span class="md-plain">pageViews</span></strong></span><span class="md-plain"> table a performance bucket is present allowing for a general visualization.</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuilds-AppInsights-Telemetry-browserTimings.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009450v30.jpeg" /></span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">Maker Defined Events</span></h3>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class=""><strong><em><span class="md-plain">traces</span></em></strong></span><span class="md-plain"> table contains </span><span class=""><strong><span class="md-plain">information sent from the app by the platform and the maker using the </span><em><span class="md-plain">Trace()</span></em><span class="md-plain"> method</span></strong></span><span class="md-plain">. For the platform trace events, the user agent string and client information is captured. For the trace method, as shown above an enumeration is used to set the severity from the Canvas App. In Application Insights this translates to a number.</span></p>
<p class="md-end-block md-p" style="padding-left: 390px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/GetBuilds-AppInsights-Telemetry-TraceSeverity.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009450v31.jpeg" /></span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Useful Kusto Queries</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class=""><strong><span class="md-plain">Kusto Query Language</span></strong></span><span class="md-plain"> allows analysts to write queries for </span><span class=""><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain">. Below I've included some queries to help you get started with each table events are currently delivered to. </span></p>
<p class="md-end-block md-p"><span class=""><strong><span><u><span class="md-plain">Pulling ms-app identifiers from custom dimensions:</span></u></span></strong></span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><span></span>[embed:dc8ab71f-3b98-42d9-b0f6-e21e02a0f8e2:203e991a-a36d-4a28-9252-d7aa67097d97:type=text&text=%2F%2FThis%20query%20shows%20how%20to%20parse%20customDimensions%20for%20the%20app%20identifiers%0D%0Atraces%0D%0A%7C%20union%20pageViews%2C%20customEvents%2C%20browserTimings%0D%0A%7C%20extend%20cd%3Dparse_json%28customDimensions%29%0D%0A%7C%20project%20timestamp%2C%20%0D%0AitemId%2C%20%2F%2Fthis%20changes%20for%20each%20call%0D%0AitemType%2C%0D%0Aoperation_Id%20%2C%20operation_ParentId%20%2C%20%2F%2Fthis%20does%20not%20changes%20for%20each%20call%0D%0Aoperation_Name%20%2C%20session_Id%20%2C%20user_Id%2C%20%0D%0Amessage%2C%20cd.%5B%27ms-appSessionId%27%5D%2Ccd.%5B%27ms-appName%27%5D%2Ccd.%5B%27ms-appId%27%5D]<span></span><br /><span>​</span></pre>
<p class="md-end-block md-p"><span class=""><strong><span><u><span class="md-plain">Pulling Page Views within the same session:</span></u></span></strong></span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><span></span>[embed:dc8ab71f-3b98-42d9-b0f6-e21e02a0f8e2:d63a7d9e-a94a-40ce-8704-e5e5b42d4a1e:type=text&text=%2F%2FThis%20query%20shows%20how%20to%20use%20a%20session_id%20to%20follow%20a%20user%27s%20path%20in%20the%20canvas%20app%0D%0ApageViews%20%0D%0A%2F%2F%20%7C%20where%20session_Id%20%3D%3D%20%22f8Pae%22%20%2F%2FWindows%2010%0D%0A%2F%2F%20%7C%20where%20session_Id%20%3D%3D%20%22YhUhd%22%20%2F%2FiOS%0D%0A%7C%20where%20%28timestamp%20%3E%3D%20datetime%282020-05-13T10%3A02%3A52.137Z%29%20and%20timestamp%20%3C%3D%20datetime%282020-05-14T12%3A04%3A52.137Z%29%29%20]<span></span></pre>
<p class="md-end-block md-p"><span class=""><strong><span><u><span class="md-plain">Slow Performing Pages or screens:</span></u></span></strong></span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><span></span>[embed:dc8ab71f-3b98-42d9-b0f6-e21e02a0f8e2:9bc2a082-3d76-4806-97fb-e94dbf32494c:type=text&text=%2F%2F%20Slowest%20pages%20%0D%0A%2F%2F%20What%20are%20the%203%20slowest%20pages%2C%20and%20how%20slow%20are%20they%3F%20%0D%0ApageViews%0D%0A%7C%20where%20notempty%28duration%29%20and%20client_Type%20%3D%3D%20%27Browser%27%0D%0A%7C%20extend%20total_duration%3Dduration%2AitemCount%0D%0A%7C%20summarize%20avg_duration%3D%28sum%28total_duration%29%2Fsum%28itemCount%29%29%20by%20operation_Name%0D%0A%7C%20top%203%20by%20avg_duration%20desc%0D%0A%7C%20render%20piechart%20]<span></span></pre>
<h2 class="md-end-block md-heading"><span class="md-plain">Connecting the Dots</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class=""><strong><span class="md-plain">Power Apps Canvas App</span></strong></span><span class="md-plain"> platform provides app contextual information for each event passed to </span><span class=""><strong><span class="md-plain">Application Insights</span></strong></span><span class="md-plain">. These include </span><span class=""><strong><span class="md-plain">operation name, operation and parent operation identifiers as well as user and session data</span></strong></span><span class="md-plain">. Most messages also include </span><span class=""><strong><span class="md-plain">custom properties titled </span><em><span class="md-plain">ms-appId</span></em><span class="md-plain">, </span><em><span class="md-plain">ms-appName</span></em><span class="md-plain"> and </span><em><span class="md-plain">ms-appSessionId</span></em></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class="md-plain">The following Kusto query is an example showing how to isolate for specific operations by a user in a player session. Using the </span><span class=""><strong><em><span class="md-plain">session_id</span></em></strong></span><span class="md-plain"> field, we can filter the specific action, which may have generated multiple events, and group them together. </span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><span></span>[embed:dc8ab71f-3b98-42d9-b0f6-e21e02a0f8e2:6fe2aa47-bff4-453d-ad50-46fcc89e809f:type=text&text=union%20%28traces%29%2C%20%28requests%29%2C%20%28pageViews%29%2C%20%28dependencies%29%2C%20%28customEvents%29%2C%20%28availabilityResults%29%2C%20%28exceptions%29%0D%0A%7C%20extend%20itemType%20%3D%20iif%28itemType%20%3D%3D%20%27availabilityResult%27%2CitemType%2Ciif%28itemType%20%3D%3D%20%27customEvent%27%2CitemType%2Ciif%28itemType%20%3D%3D%20%27dependency%27%2CitemType%2Ciif%28itemType%20%3D%3D%20%27pageView%27%2CitemType%2Ciif%28itemType%20%3D%3D%20%27request%27%2CitemType%2Ciif%28itemType%20%3D%3D%20%27trace%27%2CitemType%2Ciif%28itemType%20%3D%3D%20%27exception%27%2CitemType%2C%22%22%29%29%29%29%29%29%29%0D%0A%7C%20where%20%0D%0A%28%0D%0A%20%20%20%20%28itemType%20%3D%3D%20%27request%27%20or%20%28itemType%20%3D%3D%20%27trace%27%20or%20%28itemType%20%3D%3D%20%27exception%27%20or%20%28itemType%20%3D%3D%20%27dependency%27%20or%20%28itemType%20%3D%3D%20%27availabilityResult%27%20or%20%28itemType%20%3D%3D%20%27pageView%27%20or%20itemType%20%3D%3D%20%27customEvent%27%29%29%29%29%29%29%20%0D%0A%20%20%20%20and%20%0D%0A%20%20%20%20%28%28timestamp%20%3E%3D%20datetime%282020-04-26T05%3A17%3A59.459Z%29%20and%20timestamp%20%3C%3D%20datetime%282020-04-27T05%3A17%3A59.459Z%29%29%20%0D%0A%20%20%20%20and%20%0D%0A%20%20%20%20session_Id%20%3D%3D%20%27tmcZK%27%29%29%0D%0A%7C%20top%20101%20by%20timestamp%20desc]<span></span></pre>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">Application Insights contains a User Session feature that can help visualize and provide data points</span></strong></span><span class="md-plain"> for the specific session. The image below combines custom events and page views.</span></p>
<p class="md-end-block md-p" style="padding-left: 480px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/CanvasApps/AppInsights/CanvasApp,AppInsights.Users.SessionTimeline.JPG"><img src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/29566d21_2D00_ce2e_2D00_4b2f_2D00_b174_2D00_a6013afa0035-245500-complete/pastedimage1589496009450v32.jpeg" /></span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Next Steps</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The native functionality of </span><span class=""><strong><span class="md-plain">Azure Application Insights traceability is a relatively new feature for Canvas Apps</span></strong></span><span class="md-plain">. I would also expect to see additional messages delivered to missing tables above such as exceptions and custom metrics. In the meantime consider using a </span><span class=""><strong><span class="md-plain">Power Automate flow</span></strong></span><span class="md-plain"> to send events, a custom connector or the </span><span class=" md-link"><a href="https://docs.microsoft.com/en-us/connectors/azureloganalyticsdatacollector/" rel="noopener noreferrer" target="_blank"><span class="md-plain">Log Analytics Data Collector connector</span></a></span><span class="md-plain">. This connector requires a P1 license but does allow to </span><span class=""><strong><span class="md-plain">send data to a Log Analytics workspace</span></strong></span><span class="md-plain"> which can be queried and monitored by </span><span class=""><strong><span class="md-plain">Azure Monitor and other platforms</span></strong></span><span class="md-plain">. </span></p>
<p class="md-end-block md-p"><span class=" md-link"><a href="https://dev.applicationinsights.io/documentation/Authorization/API-key-and-App-ID" rel="noopener noreferrer" target="_blank"><span class="md-plain">Utilizing the Azure Application Insights API Key</span></a></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">Microsoft Power BI</span></strong></span><span class="md-plain"> reports can be created based off the data collected from Power Apps Canvas Apps. Consider using </span><span class="md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/export-power-bi" rel="noopener noreferrer" target="_blank"><span class="md-plain">the M Query export</span></a></span><span class="md-plain"> or </span><span class="md-link"><a href="https://dev.applicationinsights.io/documentation/Using-the-API/Power-BI" rel="noopener noreferrer" target="_blank"><span class="md-plain">building custom queries using the Application Insights API.</span></a></span></p>
<p class="md-end-block md-p"><span class="md-plain">If you are interested in learning more about </span><span class=" md-link"><a href="/crm/b/crminthefield/posts/pfe-dynamics-365-service-offerings" rel="noopener noreferrer" target="_blank"><span class=""><strong><span class="md-plain">specialized guidance and training</span></strong></span><span class="md-plain"> for monitoring or other areas of the Power Platform</span></a></span><span class="md-plain">, which includes a </span><span class=" md-link"><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-17-38/WorkshopPLUS-_2D00_-Dynamics-365-Customer-Engagement-Monitoring-with-Application-lnsights-1-Day-with-Lab_2D00_FA5D599F_2D00_20E4_2D00_4087_2D00_A713_2D00_39FBD14DF7E5.pdf" rel="noopener noreferrer" target="_blank"><span class="md-plain">monitoring workshop</span></a></span><span class="md-plain">, please contact your </span><span class=""><strong><span class="md-plain">Technical Account Manager</span></strong></span><span class="md-plain"> or </span><span class=""><strong><span class="md-plain">Microsoft representative</span></strong></span><span class="md-plain"> for further details. </span></p>
<p class="md-end-block md-p"><span class="md-plain">Your feedback is </span><span class=""><strong><span><u><span class="md-plain">extremely valuable</span></u></span></strong></span><span class="md-plain"> so please leave a comment below and I'll be happy to help where I can! Also, if you find any inconsistencies, omissions or have suggestions, </span><span class=" md-link"><a href="https://github.com/aliyoussefi/MonitoringPowerPlatform/issues" rel="noopener noreferrer" target="_blank"><span class="md-plain">please go here to submit a new issue</span></a></span><span class="md-plain">.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Index</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class=" md-link"><a href="/crm/b/crminthefield/posts/monitoring-the-power-platform-introduction"><span class="md-plain">Monitoring the Power Platform: Introduction and Index</span></a></span></p>
<p class="md-end-block md-p"></p>
<p class="md-end-block md-p"></p>