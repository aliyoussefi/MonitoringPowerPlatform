<h2 class="md-end-block md-heading"><span class="md-plain">Summary</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Continuous monitoring allows enterprises the opportunity to ensure reliable performant services are immediately available to its users. Platforms need to be able to keep up with demand in such a way that its seamless to a user. </span><span class="md-pair-s"><u><span class="md-plain">Systems that become unreliable or unusable are quickly disregarded or abandoned</span></u></span><span class="md-plain">. One sure fire way to ensure uses won't use a service is if the service is unavailable. To account for this, enterprises looks to service level agreements and business continuity strategies. Part of this strategy includes testing for availability.</span></p>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> provides features to allow organizations to quickly report and take action on current and trending availability metrics. This article will review the various tests that can be configured within the service. From there we will go into how the data is and can be collected for analysis. We will look into a use case involving monitoring the </span><span class="md-pair-s"><strong><span class="md-plain">Dataverse API</span></strong></span><span class="md-plain">. Finally, we wrap with implementing a monitoring strategy to assist with notifications and automation.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Azure Application Insights Availability Tests</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> availability tests come in three distinct groupings. The first, </span><span class="md-pair-s "><strong><span class="md-plain">reaches out to a URL from different points around the world</span></strong></span><span class="md-plain">. The second, allows for </span><span class="md-pair-s"><strong><span class="md-plain">the replay of a recorded user interaction with a site or web based service</span></strong></span><span class="md-plain">. Both of these originate from within the </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> feature itself, created in the </span><span class="md-pair-s "><strong><span class="md-plain">Azure Portal</span></strong></span><span class="md-plain"> or through the </span><span class="md-pair-s "><strong><span class="md-plain">Azure APIs</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class="md-plain">The final type of test is a completely custom test. This </span><span class="md-pair-s "><strong><span class="md-plain">custom test allows flexibility into how, what and where we test.</span></strong></span><span class="md-plain"> Due to these attributes, this type of test is ideal and will serve as the test strategy implemented below.</span></p>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">Important Note on web tests:</span></u></span></strong></span></p>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">The web test mechanism has been marked as deprecated.</span></u></span></strong></span><span class="md-plain"> As expected this announcement comes with various feedback. With this in mind, </span><span class="md-pair-s "><strong><span class="md-plain">I recommend avoiding implementing web tests</span></strong></span><span class="md-plain md-expand">. If web tests are currently being used, look to migrate to custom tests.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Building Ping Tests</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-plain">URL Ping Tests</span></strong></span><span class="md-plain"> with </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> are tests that allow the service to </span><span class="md-pair-s"><strong><u><span class="md-plain">make a request to a user specified URL</span></u></strong></span><span class="md-plain">. As documented, this test doesn't actually use ICMP but sends an HTTP request allowing for capturing response headers, duration timings, etc.</span></p>
<p class="md-end-block md-p"><span class="md-plain">For the </span><span class="md-pair-s "><strong><span class="md-plain">Power Platform</span></strong></span><span class="md-plain">, this can be useful for testing availability of </span><span class="md-pair-s "><strong><span class="md-plain">Power Apps Portals</span></strong></span><span class="md-plain"> or services utilizing </span><span class="md-pair-s "><strong><span class="md-plain">Power Virtual Agents</span></strong></span><span class="md-plain"> or custom connectors. When configuring the test, conditions can be set for the actual request to the URL. These include </span><span class="md-pair-s "><strong><span class="md-plain">the ability to include dependent requests (such as images needed for the webpage) or the ability to retry on an initial failure</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class="md-pair-s"><strong><u><span class="md-plain">test frequency can be set to run every five, ten or fifteen minutes</span></u></strong></span><span class="md-plain"> from various </span><span class="md-pair-s "><strong><span class="md-plain">Azure Data Centers</span></strong></span><span class="md-plain"> across the globe. </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/monitor-web-app-availability#create-a-url-ping-test" rel="noopener noreferrer" target="_blank"><span class="md-plain">Its recommended to test from no fewer than five locations, this will help diagnose network and latency issues.</span></a></span></p>
<p class="md-end-block md-p"><span class="md-plain">Finally, </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/monitor-web-app-availability#create-a-url-ping-test" rel="noopener noreferrer" target="_blank"><span class="md-plain">the referenced documentation</span></a></span><span class="md-plain"> recommends that </span><span class="md-pair-s"><strong><span class="md-plain">the optimal configuration for working with alerts is to set the number of test locations equal to the threshold of the alert plus two</span></strong></span><span class="md-plain">.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Building Custom Tests</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Continuing down the path of availability tests, the need to expand beyond URL ping tests will eventually come up. Situations such as </span><span class="md-pair-s "><strong><span class="md-plain">validating not only uptime but authentication, latency, service health, etc. all could benefit from custom availability tests</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class="md-plain">Before building custom tests, let's look take a closer look at the Availability table within </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain">.</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">The Availability Table</span></h3>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The availability table is where our test telemetry will reside, either from URL ping tests or custom testing. The table is designed to allow for capturing if a test was </span><span class="md-pair-s"><strong><span class="md-plain">successful, the duration (typically captured in milliseconds with a stopwatch approach), location of the test and other properties</span></strong></span><span class="md-plain">. I'll review this in depth further in the article but for now keep in mind at a minimum we want to capture successfulness, timing and location for each test.</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">Creating and Deploying an Azure Function(s)</span></h3>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-plain">Azure Functions</span></strong></span><span class="md-plain"> offer an ideal service for hosting out availability tests. </span><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">Deployable worldwide and resilient</span></u></span></strong></span><span class="md-plain">, we can quickly modify and publish changes to our tests with minimal effort. </span><span class="md-pair-s "><strong><span class="md-plain">Azure Functions</span></strong></span><span class="md-plain"> also offer a real advantage, the ability to use </span><span class="md-pair-s"><strong><span class="md-plain">a timer based trigger similar </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer?tabs=csharp#ncrontab-expressions" rel="noopener noreferrer" target="_blank"><span class="md-plain">to a CRON job</span></a></span><span class="md-plain"> (actually uses </span><span class="md-meta-i-c  md-link"><a href="https://github.com/atifaziz/NCrontab" rel="noopener noreferrer" target="_blank"><span class="md-plain">NCRONTAB expressions</span></a></span><span class="md-plain">) or an </span><span class="md-meta-i-c md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp" rel="noopener noreferrer" target="_blank"><span class="md-plain">HTTP trigger</span></a></span></strong></span><span class="md-plain"> allowing for ad-hoc test runs.</span></p>
<p class="md-end-block md-p" style="padding-left: 240px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/AppInsights/AvailabilityTests/FunctionEntryPoints.PNG"><img height="149" src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/c1eefed1_2D00_2ed8_2D00_4e70_2D00_8465_2D00_8b35f241a9f0-245500-complete/pastedimage1617882411222v1.png" width="454" /></span></p>
<h4 class="md-end-block md-heading"><span class="md-plain">Triggers</span></h4>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The image above shows two public entry points, one based on the </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp" rel="noopener noreferrer" target="_blank"><span class="md-pair-s "><strong><span class="md-plain">HttpTrigger</span></strong></span></a></span><span class="md-plain"> and one based on the </span><span class="md-pair-s "><strong><span class="md-plain">TimerTrigger</span></strong></span><span class="md-plain">. The </span><span class="md-pair-s "><strong><span class="md-plain">HttpTrigger</span></strong></span><span class="md-plain"> is relatively straight forward allowing for GET and POST messages. The advantage for the use of </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp#configuration" rel="noopener noreferrer" target="_blank"><span class="md-plain">this type of trigger is flexibility</span></a></span><span class="md-plain">, </span><span class="md-pair-s"><strong><span class="md-pair-s "><em><span class="md-plain">function requests can be sent from practically any pillar in the Power Platform</span></em></span></strong></span><span class="md-plain">, such as </span><span class="md-pair-s "><strong><span class="md-plain">Power Apps</span></strong></span><span class="md-plain">, </span><span class="md-pair-s "><strong><span class="md-plain">Power Automate Flows</span></strong></span><span class="md-plain"> or </span><span class="md-pair-s "><strong><span class="md-plain">Power Virtual Agents</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class="md-plain">The </span><span class="md-pair-s "><strong><span class="md-plain">TimerTrigger</span></strong></span><span class="md-plain"> on the other hand is, as expected, set to run on a predefined interval using the </span><span class="md-meta-i-c  md-link"><a href="https://github.com/atifaziz/NCrontab" rel="noopener noreferrer" target="_blank"><span class="md-plain">CRON (NCRONTAB) expression schema</span></a></span><span class="md-plain">. What I like about this approach is we </span><span class="md-pair-s"><strong><u><span class="md-plain">use a well known interface for scheduling tasks</span></u></strong></span><span class="md-plain"> utilizing the power of </span><span class="md-pair-s "><strong><span class="md-plain">Azure Functions</span></strong></span><span class="md-plain">. In the image above the schedule is hard coded but this can be configurable using settings contained within the </span><span class="md-pair-s "><strong><span class="md-plain">Azure Function</span></strong></span><span class="md-plain"> or elsewhere. </span></p>
<p class="md-end-block md-p"><span class="md-plain">The approach laid out here provides another major advantage. </span><span class="md-pair-s"><u><span class="md-plain">This approach is decoupled from the </span><span class="md-pair-s "><strong><span class="md-plain">Power Platform</span></strong></span><span class="md-plain"> and will not be impacted or hindered by the very platform we are testing for availability!</span></u></span></p>
<h4 class="md-end-block md-heading"><span class="md-plain">Dataverse Requests</span></h4>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The decision how best to connect and report on </span><span class="md-pair-s "><strong><span class="md-plain">Dataverse</span></strong></span><span class="md-plain"> availability is completely up to the business requirements that need to be met. </span><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">What I would recommend is to authenticate and perform a command confirming not only availability but authorization.</span></u></span></strong></span><span class="md-plain"> Below is an example of </span><span class="md-pair-s"><strong><span class="md-plain">requesting an OAuth token and performing two requests</span></strong></span><span class="md-plain">, the </span><span class="md-pair-s "><strong><em><span class="md-plain">WhoAmI</span></em></strong></span><span class="md-plain"> and </span><span class="md-pair-s "><strong><em><span class="md-plain">RetrieveCurrentOrganization</span></em></strong></span><span class="md-plain"> actions.</span></p>
<p class="md-end-block md-p" style="padding-left: 180px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/AppInsights/AvailabilityTests/CdsMethods.PNG"><img alt="" height="76" src="/resized-image/__size/400x300/__key/communityserver-components-multipleuploadfilemanager/c1eefed1_2D00_2ed8_2D00_4e70_2D00_8465_2D00_8b35f241a9f0-245500-complete/pastedimage1617882411223v2.png" width="515" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">This helps confirm that the service principal used is valid and can return responses from the </span><span class="md-pair-s "><strong><span class="md-plain">Dataverse</span></strong></span><span class="md-plain">. In my example, I had two main requirements for working with the </span><span class="md-pair-s "><strong><span class="md-plain">Dataverse</span></strong></span><span class="md-plain">: </span><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">connect using a service principal and avoid any SDK dependency</span></u></span></strong></span><span class="md-plain">. The </span><span class="md-meta-i-c md-link"><a href="https://www.softwaretestinghelp.com/how-to-test-an-application-without-requirements/" rel="noopener noreferrer" target="_blank"><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">test must reduce any potential blockers</span></u></span></strong></span></a></span><span class="md-plain"> such as license modifications or assembly version lock-in. Again, how you implement this is completely up to you.</span></p>
<h4 class="md-end-block md-heading"><span class="md-plain">Location, Location, Location...</span></h4>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Once its been determined what needs to be tested and how to go about testing, the decision on where to test and metric collection still needs an answer. Again, </span><span class="md-pair-s "><strong><span class="md-plain">Azure Function</span></strong></span><span class="md-plain"> comes to the rescue, allowing developers (DevOps engineers cover your ears) to quickly deploy from </span><span class="md-pair-s "><strong><span class="md-plain">Visual Studio</span></strong></span><span class="md-plain"> to locations around the world. That said, ideally </span><span class="md-meta-i-c md-link"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-continuous-deployment" rel="noopener noreferrer" target="_blank"><span class="md-plain">proper CI/CD processes</span></a></span><span class="md-plain"> are followed.</span></p>
<p class="md-end-block md-p" style="padding-left: 240px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/AppInsights/AvailabilityTests/AzureWorldMapDeployed.jpg"><img height="208" src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/c1eefed1_2D00_2ed8_2D00_4e70_2D00_8465_2D00_8b35f241a9f0-245500-complete/pastedimage1617882411223v3.jpeg" width="435" /></span></p>
<p class="md-end-block md-p"><span class="md-pair-s "><strong><span class="md-plain">Measuring latency across regions and continents</span></strong></span><span class="md-plain"> is natively collected by Microsoft by use of </span><span class="md-pair-s "><strong><span class="md-plain">ThousandEyes</span></strong></span><span class="md-plain">. The </span><span class="md-meta-i-c  md-link"><a href="https://www.azurespeed.com/Azure/RegionToRegionLatency" rel="noopener noreferrer" target="_blank"><span class="md-plain">Region to Region Latency tool</span></a></span><span class="md-plain">, documented </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/networking/azure-network-latency" rel="noopener noreferrer" target="_blank"><span class="md-plain">here</span></a></span><span class="md-plain">, is a good reference of the average latency between </span><span class="md-pair-s"><strong><span class="md-plain">Azure Data Centers</span></strong></span><span class="md-plain"> when performing actions across the Azure network backbone. Alternatively, you can collect latency and bandwidth information using </span><span class="md-meta-i-c  md-link"><a href="http://www.markrussinovich.com/" rel="noopener noreferrer" target="_blank"><span class="md-plain">Mark Russinovich's</span></a></span><span class="md-plain"> popular tool, </span><span class="md-pair-s "><strong><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psping" rel="noopener noreferrer" target="_blank"><span class="md-plain">PsPing</span></a></span></strong></span><span class="md-plain">. </span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Building the Availability Telemetry</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Once the application we want to test for availability has been identified and the endpoint connected to, we now need to create the availability telemetry message. As discussed above, the </span><span class="md-pair-s "><strong><em><span class="md-plain">AvailabilityResults</span></em></strong></span><span class="md-plain"> table within </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> contains columns that can be used to track successfulness of API actions and the locations from which they originated.</span></p>
<p class="md-end-block md-p"><span class="md-plain">For the </span><span class="md-pair-s"><strong><span class="md-plain">Dataverse</span></strong></span><span class="md-plain">, or in fact any HTTP invoked request, we can also capture headers from the response. This can prove beneficial to gaining insights as well into current API usage as it pertains to limits (</span><span class="md-pair-s "><strong><em><span class="md-plain">e.g. Entitlement Limits</span></em></strong></span><span class="md-plain">) or correlation identifiers. These headers work well in the </span><span class="md-pair-s "><strong><em><span class="md-plain">Custom Dimensions</span></em></strong></span><span class="md-plain"> column, a JSON serialized column providing the flexibility needed to add additional data points.</span></p>
<p class="md-end-block md-p"><span class="md-plain">That said at a minimum what I have found most useful for the </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain"> tooling is first coming up with a name for your tests. Once named, </span><span class="md-pair-s"><strong><u><span class="md-plain">setting the Run Location property will be key to grouping the tests regionally</span></u></strong></span><span class="md-plain">. Within </span><span class="md-pair-s "><strong><span class="md-plain">Azure Functions</span></strong></span><span class="md-plain"> is an environment variable called "</span><span class="md-pair-s "><strong><em><span class="md-plain">REGION_NAME</span></em></strong></span><span class="md-plain">" that provides the data center location. Finally, </span><span class="md-pair-s "><strong><span class="md-plain">setting the Success property along with the Message is needed to ensure we track uptime.</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">Optionally, duration can be set and depending on what your requirement is for this will dictate what call timings are captured. In my example I am executing a simple action call and wrapping that in a timer. Taking this duration and comparing it to </span><span class="md-meta-i-c  md-link"><a href="https://docs.microsoft.com/en-us/azure/networking/azure-network-latency" rel="noopener noreferrer" target="_blank"><span class="md-plain">the latest region to region latency</span></a></span><span class="md-plain"> should provide ample timing metrics.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Reviewing Tests</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">The messages from our availability tests will reside within the </span><span class="md-pair-s "><strong><em><span class="md-plain">AvailabilityResults</span></em></strong></span><span class="md-plain"> table with </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain">. The messages are summarized and can be drilled into visually using the Availability feature as shown below.</span></p>
<p class="md-end-block md-p" style="padding-left: 240px;"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/AppInsights/AvailabilityTests/AzureAvailabilityTestResults.PNG"><img height="291" src="/resized-image/__size/320x240/__key/communityserver-components-multipleuploadfilemanager/c1eefed1_2D00_2ed8_2D00_4e70_2D00_8465_2D00_8b35f241a9f0-245500-complete/pastedimage1617882411223v4.png" width="423" /></span></p>
<p class="md-end-block md-p"><span class="md-plain">As the image shows, the tests are grouped by name, in this case "</span><span class="md-pair-s "><strong><em><span class="md-plain">Dynamics 365 Availability Test</span></em></strong></span><span class="md-plain">". Expanding the test we can see the various regions. </span><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">Once a region is selected we can drill into the scatter plot to see how uptime may have been impacted</span></u></span></strong></span><span class="md-plain">. Consider the gif below, showing how to add filters to </span><span class="md-pair-s"><strong><span class="md-plain">expand the time window searched as well as organization version</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class="md-plain"><img alt="" height="505" src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/AppInsights/AvailabilityTests/Dynamics365AvailabilityTests.gif" width="908" /></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://raw.githubusercontent.com/aliyoussefi/MonitoringPowerPlatform/master/Artifacts/AppInsights/AvailabilityTests/Dynamics365AvailabilityTests.gif"></span></p>
<p class="md-end-block md-p"><span class="md-plain">Using the technique described above, we can now see not only </span><span class="md-pair-s"><strong><u><span class="md-plain">when a organization version changed but the beginnings of availability and duration timings</span></u></strong></span><span class="md-plain">.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Custom Availability Tests with the Dataverse API Demo</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Below is a link to </span><span class="md-meta-i-c md-link"><a href="https://www.youtube.com/channel/UC2gUZlDx50UbOxNVTnIGz8w" rel="noopener noreferrer" target="_blank"><span class="md-plain">my </span><span class="md-pair-s"><strong><span class="md-plain">YouTube</span></strong></span></a></span><span class="md-plain"> video including detailed analysis and a demo of working with availability tests within </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain">. The </span><span class="md-pair-s "><strong><span class="md-plain">demo includes setting up the test, deploying to Azure, reviewing logs and creating Azure Monitor alert rules</span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p" style="padding-left: 300px;">[View:https://www.youtube.com/watch?v=QaK7GmbJxfg&t=1s:200:100]</p>
<h2 class="md-end-block md-heading"><span class="md-plain">Sample Code</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p><span class="md-plain">Sample code can be found <a href="https://github.com/aliyoussefi/MonitoringPowerPlatform/blob/master/Samples/AzureFunction/MonitoringWithApplicationInsights/AzureFunctionAndApplicationInsights/Dynamics365Availability.cs" rel="noopener noreferrer" target="_blank">here</a>.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Next Steps</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">In this article we have reviewed how to use availability tests within </span><span class="md-pair-s "><strong><span class="md-plain">Azure Application Insights</span></strong></span><span class="md-plain">. We explored creating URL ping tests as well as building custom tests. From there, we designed and published an </span><span class="md-pair-s "><strong><span class="md-plain">Azure Function</span></strong></span><span class="md-plain"> globally to test </span><span class="md-pair-s"><strong><span class="md-plain">Dataverse</span></strong></span><span class="md-plain"> availability.</span></p>
<p class="md-end-block md-p"><span class="md-plain">As shown, not only can the availability tests let us know the uptime of an API or service but </span><span class="md-pair-s "><strong><span class="md-plain">is flexible enough to capture data points such as build versions, flow runs, etc</span></strong></span><span class="md-plain">. </span><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">Consider how to use extend the use of this type of testing to further utilize Azure Monitor capabilities such as alerting.</span></u></span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">If you are interested in learning more about </span><span class="md-meta-i-c  md-link"><a href="/crm/b/crminthefield/posts/pfe-dynamics-365-service-offerings" rel="noopener noreferrer" target="_blank"><span class="md-pair-s "><strong><span class="md-plain">specialized guidance and training</span></strong></span><span class="md-plain"> for monitoring or other areas of the Power Platform</span></a></span><span class="md-plain">, which includes a </span><span class="md-meta-i-c  md-link"><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-17-38/WorkshopPLUS-_2D00_-Dynamics-365-Customer-Engagement-Monitoring-with-Application-lnsights-1-Day-with-Lab_2D00_FA5D599F_2D00_20E4_2D00_4087_2D00_A713_2D00_39FBD14DF7E5.pdf" rel="noopener noreferrer" target="_blank"><span class="md-plain">monitoring workshop</span></a></span><span class="md-plain">, please contact your </span><span class="md-pair-s "><strong><span class="md-plain">Technical Account Manager</span></strong></span><span class="md-plain"> or </span><span class="md-pair-s "><strong><span class="md-plain">Microsoft representative</span></strong></span><span class="md-plain"> for further details. </span></p>
<p class="md-end-block md-p"><span class="md-plain">Your feedback is </span><span class="md-pair-s "><strong><span class="md-pair-s"><u><span class="md-plain">extremely valuable</span></u></span></strong></span><span class="md-plain"> so please leave a comment below and I'll be happy to help where I can! Also, if you find any inconsistencies, omissions or have suggestions, </span><span class="md-meta-i-c  md-link"><a href="https://github.com/aliyoussefi/MonitoringPowerPlatform/issues" rel="noopener noreferrer" target="_blank"><span class="md-plain">please go here to submit a new issue</span></a></span><span class="md-plain">.</span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">Index</span></h2>
<p><span class="md-plain"></span>&nbsp;</p>
<p class="md-end-block md-p md-focus"><span class="md-meta-i-c  md-link"><a href="/crm/b/crminthefield/posts/monitoring-the-power-platform-introduction#index" rel="noopener noreferrer" target="_blank"><span class="md-plain">Monitoring the Power Platform: Introduction and Index</span></a></span></p>